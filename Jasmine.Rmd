---
title: "Jasmine"
output: html_document
---

Create data
```{r}
s_mobile$mou_ln <- log(s_mobile$mou + 1)
s_mobile$revenue_ln <- log(s_mobile$revenue + 1)
#s_mobile <- mutate(s_mobile, cweight = ifelse(churn == 'yes', 1L, 49L))
## filter and sort the dataset
s_mobile_train <- s_mobile %>%
  filter(training == 1)

s_mobile_test <- s_mobile %>%
  filter(training == 0)
```


Logistic model

```{r}
result <- logistic(
  s_mobile_train, 
  rvar = "churn", 
  evar = c(
    "changer", "changem", "revenue", "overage", "roam", "conference", 
    "months", "uniqsubs", "retcalls", "dropvce", 
    "eqpdays", "refurb",  "highcreditr", "mcycle", 
   "travel", "region", "occupation", "mou_ln"
  ), 
  lev = "yes", 
  check = "standardize"
)
summary(result)
pred <- predict(result, pred_data = s_mobile_test)
plot(result, plots = "coef", custom = FALSE)
#print(pred, n = 10)
s_mobile_test <- store(s_mobile_test, pred, name = "pred_logit")
```
```{r}
acc(s_mobile_test,'pred_logit')
```



